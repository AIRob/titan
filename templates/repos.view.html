{% extends "base.html" %}
{% block subtitle %}{{ repo.name }}{% endblock %}

{% macro get_url(view='repos.view') -%}
    {% if repo.tid == 0 %}
    {{ url_for(view, git=organization.git, rname=repo.name,) }}
    {% else %}
    {{ url_for(view, git=organization.git, rname=repo.name, tname=team.name) }}
    {% endif %}
{%- endmacro %}

{% macro nav(current='dashboard') -%}
<li class="{% if current == 'code' %} active {% endif %}">
    <a href="{{ get_url() }}">Code</a>
</li>
{% if admin %}
<li class="{% if current == 'setting' %} active {% endif %}">
    <a href="{{ get_url('repos.setting') }}">Setting</a>
</li>
{% endif %}
{%- endmacro %}

{% block content %}
<div class="navbar">
  <div class="navbar-inner">
    <ul class="nav">
        {% block subnav %}
            {{ nav('code') }}
        {% endblock %}
    </ul>
  </div>
</div>
{% block subcontent %}
<div class="row-fluid">
    <div class="span4">
        <div class="input-prepend">
            <span class="add-on"><strong>SSH</strong> clone URL</span>
            <input class="span3 uneditable-input" id="prependedInput" type="text" value="{{ organization.git}}@{{ request.environ['SERVER_NAME'] }}:{{ repo.path }}">
        </div>
    </div>
    <div class="span4 pull-right">
        <div class="pull-right input-prepend">
            <ul class="inline">
                <li>
                    {% if watcher %}
                    <a class="btn" id="appendedInput" href="{{ get_url('repos.unwatch') }}">Unwatch</a>
                    {% else %}
                    <a class="btn" id="appendedInput" href="{{ get_url('repos.watch') }}">Watch</a>
                    {% endif %}
                    <span class="add-on">{{ repo.watchers }}</span>
                </li>
                <li>
                    <a class="btn" id="appendedInput" href="#">Forks</a>
                    <span class="add-on">{{ repo.forks }}</span>
                </li>
            </ul>
        </div>
    </div>
    <table class="table">
        <thead>
            <tr>
                <td>name</td>
                <td>age</td>
                <td>message</td>
            </tr>
        </thead>
        <tbody>
            {% for t in tree %}
            <tr>
                <td><a href="{{ t.url }}">{{ t.name }}</a></td>
                <td>0</td>
                <td>Not implement yet</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
{% endblock %}

